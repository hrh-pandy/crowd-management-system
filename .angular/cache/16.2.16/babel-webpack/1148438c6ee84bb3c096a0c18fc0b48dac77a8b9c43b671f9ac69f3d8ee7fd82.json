{"ast":null,"code":"import { Chart } from 'chart.js/auto';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../core/services/dashboard.service\";\nimport * as i2 from \"@angular/forms\";\nexport let DashboardComponent = /*#__PURE__*/(() => {\n  class DashboardComponent {\n    constructor(dashboardService) {\n      this.dashboardService = dashboardService;\n      this.liveOccupancy = 0;\n      this.footfall = 0;\n      this.avgDwellTime = '0 min';\n    }\n    ngOnInit() {\n      this.loadFootfall();\n      this.loadDwellTime();\n      this.loadOccupancyChart();\n    }\n    /* ---------------- FOOTFALL ---------------- */\n    loadFootfall() {\n      this.dashboardService.getFootfall().subscribe(res => {\n        console.log('Footfall API:', res);\n        // ✅ Correct mapping\n        this.footfall = res.footfall ?? 0;\n      });\n    }\n    /* ---------------- DWELL TIME ---------------- */\n    loadDwellTime() {\n      this.dashboardService.getDwellTime().subscribe(res => {\n        console.log('Dwell API:', res);\n        // Example response: { avgDwellSeconds: 510 }\n        const seconds = res.avgDwellSeconds ?? 0;\n        const mins = Math.floor(seconds / 60);\n        const secs = seconds % 60;\n        this.avgDwellTime = `${mins} min ${secs} sec`;\n      });\n    }\n    /* ---------------- OCCUPANCY CHART ---------------- */\n    loadOccupancyChart() {\n      this.dashboardService.getOccupancyTimeline().subscribe(res => {\n        console.log('Occupancy API:', res);\n        /**\n         * Expected response shape (example):\n         * {\n         *   \"timeseries\": [\n         *     { \"time\": \"08:00\", \"count\": 150 },\n         *     ...\n         *   ]\n         * }\n         */\n        const series = res.timeseries || [];\n        const labels = series.map(p => p.time);\n        const values = series.map(p => p.count);\n        // latest value = live occupancy\n        this.liveOccupancy = values[values.length - 1] || 0;\n        this.renderChart(labels, values);\n      });\n    }\n    renderChart(labels, values) {\n      new Chart('occupancyChart', {\n        type: 'line',\n        data: {\n          labels,\n          datasets: [{\n            data: values,\n            borderColor: '#0d9488',\n            backgroundColor: 'rgba(13,148,136,0.15)',\n            fill: true,\n            tension: 0.4\n          }]\n        },\n        options: {\n          responsive: true,\n          plugins: {\n            legend: {\n              display: false\n            }\n          }\n        }\n      });\n    }\n    static {\n      this.ɵfac = function DashboardComponent_Factory(t) {\n        return new (t || DashboardComponent)(i0.ɵɵdirectiveInject(i1.DashboardService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: DashboardComponent,\n        selectors: [[\"app-dashboard\"]],\n        decls: 45,\n        vars: 3,\n        consts: [[1, \"dashboard-layout\"], [1, \"sidebar\"], [1, \"logo\"], [1, \"active\"], [1, \"main\"], [1, \"topbar\"], [1, \"overview\"], [1, \"cards\"], [1, \"card\"], [1, \"up\"], [1, \"down\"], [1, \"chart-card\"], [\"id\", \"occupancyChart\"]],\n        template: function DashboardComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"aside\", 1)(2, \"div\", 2);\n            i0.ɵɵtext(3, \"kloudspot\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"nav\")(5, \"a\", 3);\n            i0.ɵɵtext(6, \"Overview\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"a\");\n            i0.ɵɵtext(8, \" Crowd Entries\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(9, \"main\", 4)(10, \"header\", 5)(11, \"h2\");\n            i0.ɵɵtext(12, \"Crowd Solutions\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(13, \"select\")(14, \"option\");\n            i0.ɵɵtext(15, \"Avenue Mall\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(16, \"section\", 6)(17, \"h3\");\n            i0.ɵɵtext(18, \"Overview\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(19, \"div\", 7)(20, \"div\", 8)(21, \"p\");\n            i0.ɵɵtext(22, \"Live Occupancy\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"h2\");\n            i0.ɵɵtext(24);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(25, \"span\", 9);\n            i0.ɵɵtext(26, \"\\u2191 10% more than yesterday\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(27, \"div\", 8)(28, \"p\");\n            i0.ɵɵtext(29, \"Today's Footfall\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(30, \"h2\");\n            i0.ɵɵtext(31);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(32, \"span\", 10);\n            i0.ɵɵtext(33, \"\\u2193 10% less than yesterday\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(34, \"div\", 8)(35, \"p\");\n            i0.ɵɵtext(36, \"Avg Dwell Time\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(37, \"h2\");\n            i0.ɵɵtext(38);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(39, \"span\", 9);\n            i0.ɵɵtext(40, \"\\u2191 6% more than yesterday\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(41, \"div\", 11)(42, \"h4\");\n            i0.ɵɵtext(43, \"Overall Occupancy\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(44, \"canvas\", 12);\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(24);\n            i0.ɵɵtextInterpolate(ctx.liveOccupancy);\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate(ctx.footfall);\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate(ctx.avgDwellTime);\n          }\n        },\n        dependencies: [i2.NgSelectOption, i2.ɵNgSelectMultipleOption],\n        styles: [\".dashboard-layout[_ngcontent-%COMP%]{display:flex;height:100vh}.sidebar[_ngcontent-%COMP%]{width:240px;background:linear-gradient(180deg,#0f766e,#064e3b);color:#fff;padding:20px}.sidebar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{font-weight:700;margin-bottom:30px}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:12px;border-radius:6px;margin-bottom:10px;cursor:pointer}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background:rgba(255,255,255,.2)}.main[_ngcontent-%COMP%]{flex:1;background:#f5f7fb;padding:20px}.topbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin-top:20px}.card[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px}.card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:10px 0}.up[_ngcontent-%COMP%]{color:green;font-size:12px}.down[_ngcontent-%COMP%]{color:red;font-size:12px}.chart-card[_ngcontent-%COMP%]{margin-top:25px;background:#fff;padding:20px;border-radius:10px}\"]\n      });\n    }\n  }\n  return DashboardComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}